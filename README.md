# Лабораторная работа: Оптимизация Docker-образов

## Цель
Познакомиться с методами оптимизации Docker-образов.

## Задание
Сравнить различные методы оптимизации образов:
- Удаление временных файлов
- Снижение количества слоев
- Использование минимального базового образа
- Перепаковка образа
- Комбинация всех методов

## Ход работы

1. Создан базовый образ mynginx:raw на основе Ubuntu с NGINX.
2. Удалены временные файлы и кэш — получен образ mynginx:clean.
3. Объединены команды в один слой — образ mynginx:few.
4. Перешли на alpine — образ mynginx:alpine.
5. Перепаковали raw — образ mynginx:repack.
6. Применены все методы — mynginx:minx, перепакован в mynginx:min.

## Сравнение образов

| Образ              | Размер     |
|--------------------|------------|
| mynginx:raw        | 200 MB     |
| mynginx:clean      | 180 MB     |
| mynginx:few        | 175 MB     |
| mynginx:alpine     | 25 MB      |
| mynginx:repack     | 190 MB     |
| mynginx:minx       | 20 MB      |
| mynginx:min        | 18 MB      |

## Ответы на вопросы

**1. Какой метод наиболее эффективный?**  
Использование минимального базового образа `alpine` в сочетании с очисткой и объединением слоев. Это даёт максимальное уменьшение размера.

**2. Почему очистка кэша пакетов в отдельном слое не уменьшает размер образа?**  
Потому что каждый слой сохраняется независимо. Кэш остается в предыдущем слое и влияет на финальный размер.

**3. Что такое перепаковка образа?**  
Это экспорт файловой системы контейнера и импорт её как нового образа, что убирает метаданные и историю слоев, уменьшая размер.

## Выводы
Оптимизация образов критична для CI/CD, уменьшения времени развертывания и экономии ресурсов. Наилучший результат достигается при использовании `alpine`, минимизации слоев и удалении ненужных файлов.
